# DeepResearch Agent 服务管理脚本使用指南

**创建日期**: 2025-12-26  
**适用项目**: 第14章 - 自动化深度研究智能体

---

## 📁 已创建的脚本文件

在 `Task06/official-code/code/chapter14/helloagents-deepresearch/` 目录下创建了以下脚本：

| 脚本文件 | 功能 | 推荐程度 |
|---------|------|---------|
| **快速启动.bat** | 一键启动，界面友好 | ⭐⭐⭐⭐⭐ |
| 启动所有服务.bat | 标准启动脚本 | ⭐⭐⭐⭐ |
| 停止所有服务.bat | 停止所有服务 | ⭐⭐⭐⭐ |
| 重启所有服务.bat | 重启所有服务 | ⭐⭐⭐⭐ |
| 服务管理说明.md | 详细使用文档 | - |

---

## 🚀 推荐使用方式

### 方式一：快速启动（最推荐）⭐⭐⭐⭐⭐

**特点**:
- ✨ 界面美观，带彩色输出
- 🎯 自动最小化服务窗口
- 🌐 自动打开浏览器
- 📊 实时显示启动进度

**使用步骤**:
```
1. 双击运行 "快速启动.bat"
2. 等待 10 秒左右
3. 按任意键，浏览器自动打开
4. 开始使用！
```

**效果预览**:
```
    ╔═══════════════════════════════════════╗
    ║   DeepResearch Agent 快速启动工具    ║
    ╚═══════════════════════════════════════╝

    📚 自动化深度研究智能体
    🚀 版本: v1.0

[1/2] 🔧 启动后端服务...
   ✅ 后端服务启动命令已发送

[2/2] 🎨 启动前端服务...
   ✅ 前端服务启动命令已发送

    ╔═══════════════════════════════════════╗
    ║         🎉 服务启动完成！            ║
    ╚═══════════════════════════════════════╝
```

---

### 方式二：标准启动脚本

**使用步骤**:
```
1. 双击 "启动所有服务.bat"
2. 等待环境检查和服务启动
3. 按任意键打开浏览器
```

**适用场景**:
- 需要查看详细启动日志
- 首次使用，想确认环境配置
- 遇到问题需要调试

---

## 🛑 停止服务

### 方式一：使用停止脚本
```
双击运行 "停止所有服务.bat"
```

### 方式二：关闭窗口（推荐）
```
直接关闭启动时打开的两个命令窗口：
- DeepResearch Backend（蓝色/绿色）
- DeepResearch Frontend（紫色/品红色）
```

---

## 🔄 重启服务

**使用场景**:
- 修改了 `.env` 配置文件
- 修改了代码
- 服务出现异常

**使用方法**:
```
双击运行 "重启所有服务.bat"
```

---

## 📍 服务地址汇总

| 服务 | 地址 | 说明 |
|-----|------|------|
| **前端界面** | http://localhost:5174 | 用户操作界面 |
| **后端API** | http://localhost:8000 | API 服务 |
| **API文档** | http://localhost:8000/docs | Swagger 文档 |
| **健康检查** | http://localhost:8000/healthz | 检查服务状态 |

---

## 🎯 使用流程图

```
开始
  ↓
双击 "快速启动.bat"
  ↓
等待 10 秒（自动启动后端和前端）
  ↓
按任意键
  ↓
浏览器自动打开 http://localhost:5174
  ↓
输入研究主题
  ↓
查看研究结果
  ↓
使用完毕，关闭命令窗口
  ↓
结束
```

---

## 💡 使用技巧

### 1. 快速检查服务状态

打开浏览器访问：
- 后端健康检查: http://localhost:8000/healthz
- 应该返回: `{"status":"ok"}`

### 2. 查看实时日志

启动服务后，两个命令窗口会显示实时日志：
- **后端窗口**: 显示 API 请求、LLM 调用、错误信息
- **前端窗口**: 显示 Vite 编译、热更新信息

### 3. 服务窗口标识

- **后端**: 窗口标题显示 "DeepResearch Backend"（蓝色/绿色）
- **前端**: 窗口标题显示 "DeepResearch Frontend"（紫色）

### 4. 快速重启单个服务

不需要重启所有服务，可以单独重启：
- 重启后端: 关闭后端窗口，重新运行快速启动脚本
- 重启前端: 关闭前端窗口，重新运行快速启动脚本

---

## ⚠️ 常见问题

### Q1: 双击脚本后一闪而过
**原因**: 
- Python 或 Node.js 未安装
- Python/Node.js 不在系统 PATH 中

**解决**:
```
1. 打开命令提示符 (cmd)
2. 运行: python --version
3. 运行: node --version
4. 如果提示"不是内部或外部命令"，需要安装或配置 PATH
```

### Q2: 端口被占用
**现象**: 启动失败，提示端口被占用

**解决**:
```
1. 运行 "停止所有服务.bat"
2. 如果还不行，手动检查端口:
   netstat -ano | findstr "8000"
   netstat -ano | findstr "5174"
3. 找到对应进程ID，使用任务管理器结束进程
```

### Q3: 前端无法连接后端
**现象**: 前端显示网络错误

**检查步骤**:
```
1. 确认后端窗口是否正常运行
2. 访问 http://localhost:8000/healthz
3. 检查 backend/.env 配置是否正确
4. 查看后端窗口的错误日志
```

### Q4: 研究请求失败
**可能原因**:
- LLM API 密钥无效
- 网络连接问题
- API 配额用尽

**检查方法**:
```
1. 查看后端窗口的详细错误信息
2. 确认 backend/.env 中的 LLM_API_KEY 有效
3. 测试网络: ping api.siliconflow.cn
4. 尝试简单主题（如 "Python"）
```

---

## 🔧 高级配置

### 修改后端端口
编辑 `backend/.env`:
```ini
PORT=8080  # 改为其他端口
```

然后在 `frontend/.env.local` 中对应修改:
```ini
VITE_API_BASE_URL=http://localhost:8080
```

### 修改前端端口
编辑 `frontend/package.json` 中的 dev 脚本:
```json
"dev": "vite --port 3000"
```

### 启用详细日志
编辑 `backend/.env`:
```ini
LOG_LEVEL=DEBUG  # 从 INFO 改为 DEBUG
```

---

## 📊 性能优化建议

### 1. 快速响应配置
```ini
# backend/.env
MAX_WEB_RESEARCH_LOOPS=1        # 减少研究循环
FETCH_FULL_PAGE=False           # 不获取完整页面
LLM_MODEL_ID=Qwen/Qwen2.5-3B-Instruct  # 使用更小的模型
```

### 2. 高质量研究配置
```ini
# backend/.env
MAX_WEB_RESEARCH_LOOPS=3        # 增加研究深度
FETCH_FULL_PAGE=True            # 获取完整内容
SEARCH_API=tavily               # 使用高质量搜索
LLM_MODEL_ID=Qwen/Qwen2.5-7B-Instruct  # 使用更大的模型
```

---

## 📚 相关文档

- **项目根目录**: `C:\Users\frankechen\CFP-Study\Task06\official-code\code\chapter14\helloagents-deepresearch\`
- **详细说明**: `服务管理说明.md`
- **配置指南**: `第14章配置完成总结.md`
- **问题排查**: `第14章问题解决总结.md`

---

## 🎓 学习资源

- 官方文档: https://github.com/datawhalechina/hello-agents/tree/main/docs/chapter14
- 官方代码: https://github.com/datawhalechina/hello-agents/tree/main/code/chapter14
- 学习笔记: `Task06/学习笔记/第14章-自动化深度研究智能体.md`

---

## ✨ 脚本特性总结

| 特性 | 快速启动 | 标准启动 | 说明 |
|-----|---------|---------|------|
| 自动环境检查 | ❌ | ✅ | 标准版会检查 Python/Node.js |
| 彩色界面 | ✅ | ⚪ | 快速版有更好的视觉效果 |
| 窗口最小化 | ✅ | ❌ | 快速版自动最小化服务窗口 |
| 自动打开浏览器 | ✅ | ✅ | 两个版本都支持 |
| 错误提示 | ⚪ | ✅ | 标准版有更详细的错误提示 |
| 启动速度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 快速版稍快 |

**推荐**: 日常使用选择"快速启动"，遇到问题时使用"标准启动"查看详细日志。

---

**创建日期**: 2025-12-26  
**创建者**: CodeBuddy Code  
**版本**: v1.0
