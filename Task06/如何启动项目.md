# 如何启动智能旅行助手项目

> **环境已配置完成！** 所有依赖已安装，API 密钥已配置。

---

## ✅ 配置完成清单

- ✅ 官方代码已克隆
- ✅ Python 虚拟环境已创建
- ✅ 后端依赖已安装 (hello-agents, fastapi, uvicorn 等)
- ✅ 前端依赖已安装 (vue, ant-design-vue 等)
- ✅ 后端 .env 已配置 (高德地图 Key: 3fb674a8...、Claude LLM)
- ✅ 前端 .env 已配置 (高德地图 JS Key: 3fb674a8...)

---

## 🚀 启动步骤

### 方式一：手动启动（推荐学习）

#### 步骤 1: 启动后端

**打开第一个 PowerShell 窗口**：

```powershell
# 进入后端目录
cd C:\Users\frankechen\CFP-Study\Task06\official-code\code\chapter13\helloagents-trip-planner\backend

# 激活虚拟环境
.\venv\Scripts\Activate.ps1

# 启动后端服务
uvicorn app.api.main:app --reload --host 0.0.0.0 --port 8000
```

**成功标志**：
```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process
INFO:     Started server process
INFO:     Application startup complete.
```

---

#### 步骤 2: 启动前端

**打开第二个 PowerShell 窗口**（保持后端运行）：

```powershell
# 进入前端目录
cd C:\Users\frankechen\CFP-Study\Task06\official-code\code\chapter13\helloagents-trip-planner\frontend

# 启动前端服务
npm run dev
```

**成功标志**：
```
VITE v6.0.7  ready in xxx ms

➜  Local:   http://localhost:5173/
```

---

#### 步骤 3: 访问应用

打开浏览器访问：
- **前端页面**: http://localhost:5173
- **API 文档**: http://localhost:8000/docs

---

### 方式二：使用启动脚本

**一键启动（在新窗口中运行）**：

```powershell
cd C:\Users\frankechen\CFP-Study\Task06\实践环境
.\一键启动全部.ps1
```

脚本会自动：
1. 在新窗口中启动后端
2. 在另一个新窗口中启动前端
3. 打开浏览器访问应用

---

## 🎯 测试功能

### 示例测试场景

在浏览器中访问 http://localhost:5173，填写以下信息：

```
目的地：北京
旅行天数：3天
出发日期：2025-12-28
交通方式：公共交通
住宿偏好：经济型
旅行风格：文化探索、美食体验
```

点击 **"生成旅行计划"**，AI 将为您生成详细的 3 天北京行程！

### 预期结果

- ✅ 后端调用 Claude 进行智能规划
- ✅ 自动调用高德地图 API 搜索景点
- ✅ 获取天气信息
- ✅ 推荐酒店位置
- ✅ 生成每日详细行程
- ✅ 在地图上标注景点位置

---

## 📊 服务端口

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端 | http://localhost:5173 | Vue3 应用界面 |
| 后端 | http://localhost:8000 | FastAPI 服务 |
| API 文档 | http://localhost:8000/docs | Swagger UI |
| API Redoc | http://localhost:8000/redoc | ReDoc 文档 |

---

## 🔧 配置信息

### 后端配置 (backend/.env)

```env
# LLM 配置
LLM_MODEL_ID=claude-4.5-sonnet
LLM_API_KEY=inherited-from-environment
LLM_BASE_URL=https://api.anthropic.com

# 高德地图 API
AMAP_API_KEY=3fb674a8c918bfcf5c6c310c4a3adba8

# 服务器配置
HOST=0.0.0.0
PORT=8000
CORS_ORIGINS=http://localhost:5173,http://localhost:3000
```

### 前端配置 (frontend/.env)

```env
# 高德地图 JavaScript API Key
VITE_AMAP_WEB_KEY=3fb674a8c918bfcf5c6c310c4a3adba8

# 后端 API 地址
VITE_API_BASE_URL=http://localhost:8000
```

---

## 🐛 常见问题

### 1. 后端启动失败：找不到模块

**解决方案**：
```powershell
# 确保在 backend 目录
cd backend

# 重新激活虚拟环境
.\venv\Scripts\Activate.ps1

# 检查依赖是否安装
pip list | Select-String hello-agents
```

### 2. 前端启动失败：端口被占用

**解决方案**：
```powershell
# 查找占用端口的进程
netstat -ano | findstr :5173

# 终止进程（替换 PID）
taskkill /PID <进程ID> /F
```

### 3. API 调用失败

**检查步骤**：
1. 确认后端已启动：访问 http://localhost:8000/docs
2. 检查浏览器控制台（F12）查看错误信息
3. 查看后端窗口的日志输出

### 4. 高德地图不显示

**可能原因**：
- 高德地图 Key 配置错误
- Key 的域名绑定不包含 localhost

**解决方案**：
1. 检查前端 .env 中的 VITE_AMAP_WEB_KEY
2. 访问 [高德开放平台控制台](https://console.amap.com/dev/key/app)
3. 确保 Key 绑定域名包含 `localhost`

---

## 📚 后续学习

### 代码阅读顺序

1. **数据模型** (15分钟)
   - `backend/app/models/schemas.py`
   - 理解 Pydantic 模型定义

2. **API 路由** (20分钟)
   - `backend/app/api/routes/trip.py`
   - 理解请求处理流程

3. **智能体实现** (30分钟)
   - `backend/app/agents/trip_planner_agent.py`
   - 理解 HelloAgents 的使用

4. **服务层** (25分钟)
   - `backend/app/services/amap_service.py`
   - 理解 MCP 工具封装

5. **前端组件** (30分钟)
   - `frontend/src/views/Home.vue`
   - `frontend/src/views/Result.vue`
   - 理解 Vue3 组件开发

### 学习资源

- 📖 [第13章官方学习指南](./学习笔记/第13章-智能旅行助手-官方学习指南.md)
- 🔧 [环境配置详细指南](./实践环境/环境配置指南.md)
- 📘 [官方文档](https://github.com/datawhalechina/hello-agents/blob/main/docs/chapter13/第十三章%20智能旅行助手.md)

---

## 🎉 开始使用

现在您可以：

1. ✅ 按照上面的步骤启动项目
2. ✅ 体验 AI 旅行规划功能
3. ✅ 阅读代码理解实现原理
4. ✅ 尝试修改和扩展功能

**祝您学习愉快！** 🚀

---

**创建时间**: 2025-12-25  
**配置完成**: 2025-12-25 22:15  
**状态**: ✅ 随时可以启动
